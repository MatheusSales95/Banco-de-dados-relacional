CREATE TABLE "AreaDesmatada" (
  "id_area" INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "localizacao" varchar(255) NOT NULL,
  "tamanho_hectares" decimal(10,2) NOT NULL,
  "data_registro" date NOT NULL
);

CREATE TABLE "AgenteResponsavel" (
  "id_agente" INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nome" varchar(255) NOT NULL,
  "tipo" "enum(Pessoa Física,Empresa,Organização)" NOT NULL,
  "CPF_CNPJ" varchar(20) UNIQUE NOT NULL
);

CREATE TABLE "Fiscalizacao" (
  "id_fiscalizacao" INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "orgao_responsavel" varchar(100) NOT NULL,
  "data_fiscalizacao" date NOT NULL,
  "resultado" "enum(Multado,Embargado,Sem irregularidade)" NOT NULL
);

CREATE TABLE "Agente_Area" (
  "id_agente" int,
  "id_area" int,
  "primary" key(id_agente,id_area)
);

CREATE TABLE "Fiscalizacao_Area" (
  "id_fiscalizacao" int,
  "id_area" int,
  "primary" key(id_fiscalizacao,id_area)
);

CREATE TABLE "Fiscalizacao_Agente" (
  "id_fiscalizacao" int,
  "id_agente" int,
  "primary" key(id_fiscalizacao,id_agente)
);

CREATE INDEX "idx_area_localizacao" ON "AreaDesmatada" ("localizacao");

CREATE INDEX "idx_area_data" ON "AreaDesmatada" ("data_registro");

CREATE INDEX "idx_agente_cpf_cnpj" ON "AgenteResponsavel" ("CPF_CNPJ");

CREATE INDEX "idx_fiscalizacao_data" ON "Fiscalizacao" ("data_fiscalizacao");

COMMENT ON TABLE "Agente_Area" IS 'Tabela de junção entre AgenteResponsavel e AreaDesmatada';

COMMENT ON TABLE "Fiscalizacao_Area" IS 'Tabela de junção entre Fiscalizacao e AreaDesmatada';

COMMENT ON TABLE "Fiscalizacao_Agente" IS 'Tabela de junção entre Fiscalizacao e AgenteResponsavel';

ALTER TABLE "Agente_Area" ADD FOREIGN KEY ("id_agente") REFERENCES "AgenteResponsavel" ("id_agente");

ALTER TABLE "Agente_Area" ADD FOREIGN KEY ("id_area") REFERENCES "AreaDesmatada" ("id_area");

ALTER TABLE "Fiscalizacao_Area" ADD FOREIGN KEY ("id_fiscalizacao") REFERENCES "Fiscalizacao" ("id_fiscalizacao");

ALTER TABLE "Fiscalizacao_Area" ADD FOREIGN KEY ("id_area") REFERENCES "AreaDesmatada" ("id_area");

ALTER TABLE "Fiscalizacao_Agente" ADD FOREIGN KEY ("id_fiscalizacao") REFERENCES "Fiscalizacao" ("id_fiscalizacao");

ALTER TABLE "Fiscalizacao_Agente" ADD FOREIGN KEY ("id_agente") REFERENCES "AgenteResponsavel" ("id_agente");
